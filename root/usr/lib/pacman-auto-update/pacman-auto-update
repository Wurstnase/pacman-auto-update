#! /bin/bash


mainFunction () {
	if ! connectionIsMetered && [[ ! -f "/var/lib/pacman/db.lck" ]]; then
		sudo pacman --sync --refresh --sysupgrade --quiet --noconfirm
	fi
}


connectionIsMetered () {
	if [[ -f "/usr/bin/nmcli" ]] &&
	[[ ! -z "$(nmcli --terse --fields GENERAL.METERED dev show | grep "yes")" ]]; then
		true
	else
		false
	fi
}


prepareEnvironment () {
	set -e
	trap "" INT QUIT TERM EXIT
}


mainFunction
